### Общее понятие
##### Технически верное
*Сервисы* — это классы, реализующие определенную функциональность приложения (бизнес-логику или инфраструктурные задачи).
Они выступают в роли зависимостей, которые регистрируются в [[DI Basics#Inversion of Control (IoC)|DI-контейнере]]. Использование контейнера в связке с абстракциями (интерфейсами) обеспечивает **слабую связность** компонентов и соблюдение принципа **Инверсии управления**.

##### Более понятное
*Сервисы* — это классы, реализующие конкретные задачи. Их цель — **инкапсуляция логики** (скрытие реализации внутри) и предоставление публичных методов для её использования.

Чаще всего сервисы берут на себя:
* **Бизнес-логику:** Основные алгоритмы и правила программы (расчеты, проверки условий, принятие решений).
* **Инфраструктурные задачи:** Технические операции для связи с внешним миром (запросы к БД, чтение файлов, отправка email).

Регистрация сервисов в [[DI Basics#Inversion of Control (IoC)|DI-контейнере]] меняет подход к созданию объектов: класс больше сам не создает свои зависимости (через `new`), а получает готовые экземпляры извне.


### Категории сервисов
**1. Встроенные (Framework Services)**
  Сервисы, которые идут в комплекте с ASP.NET Core, но не включены по умолчанию для экономии ресурсов. Мы подключаем их только по необходимости

**2. Сторонние (Third-party)**
  Библиотеки и NuGet-пакеты, которые предоставляют свои методы расширения для свойства *Services*


### Основные готовые модули
**Безопасность**
  *Authentication* (Аутентификация) — проверка, кто именно делает запрос
  *Authorization* (Авторизация) — проверка прав доступа
  *CORS* — разрешение или запрет запросов с других доменов (клиентов)
  *Antiforgery* — защита от межсайтовой подделки запросов (CSRF)

**Веб-архитектура**
  *MVC / Controllers* — работа с контроллерами и представлениями
  *Localization* — поддержка разных языков
  *Cookies* — управление куки-файлами


### Правила подключения
**Свойство builder.Services**
  Это коллекция (`IServiceCollection`), куда мы складываем все необходимые зависимости

**Методы расширения**
  Для удобства сервисы обычно подключаются методами, начинающимися на `Add...` (например, `.AddAuthentication()`)

**Строгая последовательность**
  Регистрация сервисов должна происходить **до** вызова метода `builder.Build()`. После того как приложение "построено", добавить в него новые детали нельзя

### Пример регистрации
```csharp
var builder = WebApplication.CreateBuilder(args);

// 1. Регистрация сервисов (Всегда ДО Build)
builder.Services.AddAuthentication();
builder.Services.AddControllers(); // Подключение контроллеров
builder.Services.AddCors();        // Подключение CORS

// 2. Сборка приложения
var app = builder.Build();