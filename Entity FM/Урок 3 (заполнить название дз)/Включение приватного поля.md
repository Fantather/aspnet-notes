В EF Core есть нюанс: **по умолчанию он работает с публичными свойствами**, но можно работать и с приватными полями (field mapping). Давай оформим это для Obsidian:

---

### Приватные поля (Private Fields) в EF Core

- **Для чего:**  
    Иногда нужно хранить данные **внутри класса**, но **не делать их публичными**. EF Core умеет читать и писать приватные поля через **field mapping**.
    
- **Пример с приватным полем:**
    

```c#
public class Company {
public int Id { get; set; }     
public string Name { get; set; }      // приватное поле     
private string _secretCode;      // публичный метод для работы с полем     
public void SetSecretCode(string code) => _secretCode = code;     public string GetSecretCode() => _secretCode; }
```

- **Fluent API для привязки поля к колонке:**
```c#
modelBuilder.Entity<Company>()     
.Property<string>("_secretCode") // имя приватного поля     
.HasColumnName("SecretCode");    // имя колонки в БД
```
![[Pasted image 20250905191611.png]]

- **Особенности:**
    
    - Поле **может быть полностью приватным**, EF Core всё равно сохранит его в БД.
        
    - Можно использовать **readonly-поля** для защиты данных от изменения извне.
        
    - Атрибут `[NotMapped]` также работает — поле можно игнорировать.
___
### Приватные поля и Data Annotations

- **Важно:**  
    Data Annotations в EF Core **работают только с публичными свойствами**, а не с приватными полями напрямую.
    
    - `[Key]`, `[Required]`, `[Column]`, `[NotMapped]` — всё это применяется **к свойствам класса**.
        
    - Приватное поле без публичного свойства **не может быть напрямую помечено Data Annotation**.
        
- **Как обойти через Data Annotations:**
    
    - Сделать **публичное свойство** с `private set`:
```c#
public class Company
{
    public int Id { get; set; }

    [Required]
    [Column("SecretCode")]
    public string SecretCode { get; private set; } // приватный сеттер
}

```
EF Core сможет записывать значение в колонку `SecretCode`, но из кода **изменять его можно только через метод класса**:
```c#
public void SetSecretCode(string code) => SecretCode = code;

```

#резюме 
- **Прямо приватное поле через Data Annotations нельзя пометить**.
- Решение: **публичное свойство с приватным сеттером** или Fluent API для полного private field mapping.