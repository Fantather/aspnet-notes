### Складовой (Composite) первичный ключ
[[Первинний ключ]]
- **Определение:**  
    Складовой ключ — это **PK, который состоит из нескольких колонок одновременно**.  
    Гарантирует **уникальность комбинации значений**, а не отдельных колонок.
```c#
public class OrderItem
{
    public int OrderId { get; set; }
    public int ProductId { get; set; }
    public int Quantity { get; set; }
}

modelBuilder.Entity<OrderItem>()
    .HasKey(oi => new { oi.OrderId, oi.ProductId });

```

- В БД:
    
    - `OrderId + ProductId` = составной PK
        
    - Нельзя добавить дубликат с такой же комбинацией
        

---

####  Особенности

- **Нельзя сделать через Data Annotations** напрямую (`[Key]` работает только для одного свойства)
    
- Используется, когда:
    
    - Один столбец **не уникален**, но комбинация нескольких столбцов уникальна
        
    - Таблица представляет **отношение "многие ко многим"** или детали заказа
    -
#### Важные моменты

- Composite PK может использоваться как FK в других таблицах
    
- EF Core поддерживает навигацию и индексы для таких ключей
    
- Обычно комбинируют **ID заказа + ID продукта**, **UserId + RoleId** и т.д.
