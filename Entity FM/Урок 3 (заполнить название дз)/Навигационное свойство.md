### Навигационные свойства (Navigation Properties) в C# / EF Core

- **Определение:**  
    Свойство класса, которое ссылается на другой объект (сущность).  
    Оно **не хранит саму таблицу в БД**, а лишь позволяет работать с связанной сущностью в коде.
    
- **Пример:**
```c#
public class Company
{
    public int Id { get; set; }
    public string Name { get; set; }

    // Навигационное свойство
    public Country Country { get; set; }  

    // В БД будет храниться только:
    public int CountryId { get; set; } 
}

```


![[Pasted image 20250905184822.png]]
Объект Company подтянется вслед за объектом, свойством которого он является
Это навигационное свойство
![[Pasted image 20250905184848.png]]
В БД подтянется таблица Country и в нашей модели будет храниться соответствующий ID

**Как это работает:**

- EF Core подтягивает объект `Country` при необходимости (lazy/eager loading).
    
- В самой БД хранится **только внешний ключ** `CountryId`.
    
- В коде через навигационное свойство можно обращаться к связанному объекту напрямую:
```c#
var company = db.Companies.Include(c => c.Country).First();
Console.WriteLine(company.Country.Name);

```


![[Pasted image 20250905184904.png]]

___

#резюме 
- Навигационное свойство связывает объекты, а не таблицы напрямую.
    
- В БД создаётся внешний ключ (`FK`), который хранит ID связанной записи.
    
- Позволяет использовать LINQ для удобной работы с зависимыми сущностями.
___
### Навигационные свойства и каскадное удаление

- **Каскадное удаление (Cascade Delete):**  
    Если таблица `Company` удаляется, **связанные объекты `Country` тоже могут удалиться**, если они связаны только через `Company`.
    
    - Это задаётся в EF Core через **конфигурацию отношений** или атрибуты `[Required]` / Fluent API.
        
    - Пример Fluent API:
        
        `modelBuilder.Entity<Company>()     .HasOne(c => c.Country)     .WithMany()     .OnDelete(DeleteBehavior.Cascade);`
        
- **Метаданные и атрибуты:**
    
    - Все, что мы прописываем в **атрибутах `[Key]`, `[Required]`, `[ForeignKey]` и др.** сохраняется в **метаданных модели** EF Core.
        
    - Метаданные нужны для:
        
        - построения схемы БД (`CREATE TABLE`, `FOREIGN KEY` и т.д.)
            
        - валидации данных при сохранении
            
        - генерации миграций
из метаданных можно вытащить все по атрибутам
